name: ddev-typo3-solr

pre_install_actions:
- ddev composer config --no-plugins allow-plugins.typo3/cms-composer-installers true
- ddev composer req "apache-solr-for-typo3/solr:^12.0.0-beta-1"

project_files:
- commands/solr/solr
- solr
- docker-compose.solr.yaml

post_install_actions:
- cp -r ${DDEV_APPROOT}/vendor/apache-solr-for-typo3/solr/Resources/Private/Solr/configsets ${DDEV_APPROOT}/.ddev/solr
- cp -r ${DDEV_APPROOT}/vendor/apache-solr-for-typo3/solr/Resources/Private/Solr/cores ${DDEV_APPROOT}/.ddev/solr
- cp ${DDEV_APPROOT}/vendor/apache-solr-for-typo3/solr/Resources/Private/Solr/solr.xml ${DDEV_APPROOT}/.ddev/solr/solr.xml

removal_actions:
- rm -rf ~/.ddev/solr
